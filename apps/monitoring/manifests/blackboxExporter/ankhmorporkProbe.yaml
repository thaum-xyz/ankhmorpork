apiVersion: monitoring.coreos.com/v1
kind: Probe
metadata:
  labels:
    app.kubernetes.io/component: exporter
    app.kubernetes.io/name: blackbox-exporter
    app.kubernetes.io/part-of: kube-prometheus
    app.kubernetes.io/version: 0.23.0
  name: ankhmorpork
  namespace: monitoring
spec:
  module: http_2xx
  prober:
    url: blackbox-exporter.monitoring.svc:19115
  targets:
    staticConfig:
      labels:
        environment: ankhmorpork
      relabelingConfigs:
      - regex: https://192.168.2.29/redirect.html
        replacement: qnap.ankhmorpork.thaum.xyz
        sourceLabels:
        - instance
        targetLabel: instance
      - regex: $1/-/healthy
        sourceLabels:
        - instance
        targetLabel: instance
      - regex: $1/api/health
        sourceLabels:
        - instance
        targetLabel: instance
      static:
      - https://192.168.2.29/redirect.html
      - https://prometheus.ankhmorpork.thaum.xyz/-/healthy
      - https://alertmanager.ankhmorpork.thaum.xyz/-/healthy
      - https://grafana.ankhmorpork.thaum.xyz/api/health
  tlsConfig:
    insecureSkipVerify: true
