---
version: 'v0.30.2'  # application-version-from-github: thanos-io/thanos
image: "quay.io/thanos/thanos:v0.30.2"  # application-image-from-github: thanos-io/thanos
namespace: "datalake-metrics"
imagePullPolicy: 'IfNotPresent'
hashringConfigMapName: 'hashring-config'
volumeClaimTemplate:
  spec:
    accessModes: ['ReadWriteOnce']
    storageClassName: 'qnap-nfs'
    resources:
      requests:
        storage: '30Gi'
objectStorageConfig:
  name: 'thanos-objectstorage'
  key: 'thanos.yaml'
  credentialsRefs:
    access_key: 'THANOS_S3_ACCESS_KEY'
    secret_key: 'THANOS_S3_SECRET_KEY'
  content: |
    type: S3
    config:
      bucket: thaum-datalake-metrics
      endpoint: fra1.digitaloceanspaces.com
      access_key: {{ .access_key }}
      secret_key: {{ .secret_key }}
    prefix: thanos

# reference to htpasswd file storred in doppler. Content later available in Secret 'thanos-receive-ingress-auth'.
ingressAuthHTPasswdRef: THANOS_INGRESS_HTPASSWD

receiveIngestor:
  resources:
    requests:
      cpu: 250m
      memory: 1500Mi
    limits:
      cpu: 400m
      memory: 2Gi
receiveRouter:
  resources:
    requests:
      cpu: 200m
      memory: 50Mi
#    limits:
#      cpu: 300m
#      memory: 200Mi
store:
  resources:
    requests:
      cpu: 500m
      memory: 1Gi
    limits:
      cpu: 3
      memory: 10Gi
query:
  resources:
    requests:
      cpu: 15m
      memory: 40Mi
