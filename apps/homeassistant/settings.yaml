---
common:
  namespace: &namespace "homeassistant"
homeassistant:
  version: "2023.4.4"  # application-version-from-github: home-assistant/core
  image: "homeassistant/aarch64-homeassistant:2023.4.3"  # application-image-from-github: home-assistant/core
  namespace: *namespace
  ingress:
    domain: "home.ankhmorpork.thaum.xyz"
    className: 'nginx'
    annotations:
      'cert-manager.io/cluster-issuer': 'letsencrypt-prod'
  hostNetwork: true  # Needed to enable WOL
  timezone: "Europe/Berlin"
  resources:
    # DO NOT DECREASE IT
    # HomeAssistant image has built-in memory management which doesn't propagate to kubernetes
    # this in turn requires to add more resources than it is actually needed
    requests:
      cpu: 700m
      memory: 500Mi
    # limits:
    #   cpu: 2
    #   memory: 1300Mi
  apiTokenRef: "HOMEASSISTANT_PROMETHEUS_TOKEN"
  apiTokenSecretKeySelector:
    name: 'credentials'
    key: 'token'
  storage:
    name: "homeassistant-config"
    pvcSpec:
      storageClassName: "qnap-nfs"
      accessModes:
        - ReadWriteOnce
      resources:
        requests:
          storage: 1Gi
  #encryptedAPIToken: "AgA/Ri+rPl/uXghEhXK1AjUpvqpjy0UlG1DNRVP3Pu8PDWvGozJN4oyth3IDOJ0yePW4HaGxF9expzWJ0Ett9dD+5nooknLd4RwDVYXxiyWzIMVIfR7/Sy2es/YqPHH7g1IEkrYEEjf9QWzZybr739H/jTbBrXqmWN2v0lXPBoF/nt8hILdPb8uY4yzFFw2OGDIWw12hUTLaGs91LVZqEVhn1ypx6yCu4xAdA997/33ye8wQcYiLv9eGQBmtMOmDSKk43tT7G8iyB8HVhcJO7FFmo51XGMRLEKItr+bUpX/zIQpkNqQakiHUsmKwJL3A/6lnkDV0l443vaeFJQHqckM/MY0YM2yqhQrDCGgklK2bhoW8X2fgC/2ptThQYTrK6aPJSpcEC7Ap5IxAMFPq9QNGtffQc12moIKVyPMpZu3eNN1k5H02s2Bqf+f6X/s4fM5rvI6QZZPlT3ttQw3XnqB5smky70OH3JX56pqdVLdpjcyzuCmGBRWbA2ZRa2e3EZFteCOHUR9nP2h8Dekc6YltmScreDobm1e2v5TW7bHAmL86rM0T0lSCX/I40igTBv1xjC1ePzr6cxf0+XInRvd/wVav6hniQAQPBdg1P/mxmD2IXntku0m+l3dzaubwH8nmv4ZMsg8/w1ZpzQCVsHHpGH11uSFhUFPvLZ+kMEX6PUDbUPwZ+hayse6JiOFNlLlhPh+jmQJi27HLcC1f614y0wpoSaaW1Ze5xNauauL4/h/WbzZheUCn26eqvGICgobc1TB6xZmjEG644y0p0b5e3k2M1Z8jJdEDawd8LiFA+SHpDgozTv8AkrgvtYsf1s/sscPwDq2ZodhGWGBi9u/mv/MimGm79znCBpeQvrh45NaSRAYJAMgdC5VgIUg9Oviaf5P+DkTqj6jj9GplyQVNHbhmwg5lVW8gWSZRPildZWd8l7M9AaE="
timescaledb:
  version: "2.10.1"  # application-version-from-github: timescale/timescaledb
  image: "timescale/timescaledb:2.10.1-pg14"  # application-version-from-github: timescale/timescaledb
  namespace: *namespace
  resources:
    requests:
      cpu: 130m
      memory: 300Mi
    limits:
      cpu: 250m
      memory: 420Mi
  storage:
    name: "timescaledb-data"
    pvcSpec:
      storageClassName: "qnap-nfs"
      accessModes:
        - ReadWriteOnce
      resources:
        requests:
          storage: 300Mi
  database:
    userRef: HOMEASSISTANT_DB_USER
    passRef: HOMEASSISTANT_DB_PASS
    name: "homeassistant"
esphome:
  version: "2023.3.2"  # application-version-from-github: esphome/esphome
  image: "esphome/esphome:2023.3.2"  # application-image-from-github: esphome/esphome
  namespace: *namespace
  resources:
    requests:
      cpu: 1
      memory: 500Mi
    limits:
      cpu: 1400m
      memory: 1400Mi
  storage:
    name: "esphome-data"
    pvcSpec:
      storageClassName: "qnap-nfs"
      accessModes:
        - ReadWriteOnce
      resources:
        requests:
          storage: 300Mi
espdevices:
  name: "esp-dev"
  namespace: *namespace
  interval: 60s
  addresses:
  - '192.168.2.221'
  - '192.168.2.222'
  #- '192.168.2.224'
